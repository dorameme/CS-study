# 스푸핑 공격 상세 분석

## ARP 스푸핑 (ARP Spoofing)

**정의**
- 데이터 링크 계층에서 ARP 프로토콜의 신뢰성 부재 취약점을 이용하여 MAC 주소를 위조하는 공격

**방법**
- 공격자가 특정 IP 주소에 해당하는 MAC 주소가 자신의 MAC 주소라고 위조 ARP 응답 전송
- 정기적인 ARP 요청 브로드캐스트를 이용한 ARP 테이블 갱신
- 지속적인 위조 ARP 패킷 전송으로 진품 ARP 응답을 덮어쓰기

**원리**
- ARP 프로토콜은 인증 메커니즘이 없어 누구나 ARP 응답 가능
- 스위치는 MAC 주소 학습 시 별도 인증 과정 없이 최신 ARP 응답 수용
- 공격자의 위조 ARP 응답이 진품보다 빠르게 도착하면 표적의 ARP 테이블 오염

**예시**
- 공격자: MAC 주소 CC:CC:CC:CC:CC:CC
- 게이트웨이: 192.168.1.1, MAC 주소 AA:AA:AA:AA:AA:AA
- 희생자: 192.168.1.100, MAC 주소 BB:BB:BB:BB:BB:BB
- 공격자가 희생자에게 "192.168.1.1의 MAC은 CC:CC:CC:CC:CC:CC"라고 위조 응답
- 희생자의 인터넷 트래픽이 공격자를 통해 전송되며 감청 가능

---

## IP 스푸핑 (IP Spoofing)

**정의**
- 네트워크 계층에서 출발지 IP 주소를 위조하여 패킷을 생성·전송하는 공격

**방법**
- raw socket 프로그래밍을 통한 패킷 헤더 직접 조작
- 출발지 IP를 신뢰할 수 있는 호스트 IP로 설정
- TCP 시퀀스 번호 예측을 통한 연결 하이재킹

**원리**
- IP 프로토콜은 출발지 주소 인증 메커니즘 부재
- 라우터는 목적지 IP 기반으로만 패킷 전달
- 신뢰 관계 기반 서비스에서는 출발지 IP만으로 인증

**예시**
- A 회사(IP: 203.0.113.10)와 B 회사(IP: 198.51.100.20) 간 신뢰 관계 존재
- 공격자가 출발지 IP를 203.0.113.10으로 위조하여 B 회사 서버 접근
- B 회사 서버는 공격자를 A 회사로 인식하여 무단 접근 허용

---

## DNS 스푸핑 (DNS Spoofing)

**정의**
- 응용 계층에서 DNS 응답을 위조하여 사용자를 악성 사이트로 유도하는 공격

**방식**
- DNS 캐시 포이즈닝: DNS 서버 캐시에 잘못된 정보 주입
- MITM 공격: DNS 쿼리 가로채어 위조 응답 전송
- 호스트 파일 변조: 로컬 DNS 해석 결과 조작

**원리**
- DNS 프로토콜의 트랜잭션 ID 예측 가능성 취약점
- DNS 응답의 무결성 검증 메커니즘 부재
- 캐시 TTL 만료 시까지 위조 정보 유지

**예시**
- 사용자가 www.bank.com 접속 시도
- 공격자가 DNS 쿼리 가로채어 203.0.113.99(악성 사이트) 응답
- 사용자는 가짜 뱅킹 사이트에 접속하여 계정 정보 입력
- 공격자가 개인정보 탈취

---

## DHCP 스푸핑 (DHCP Spoofing)

**정의**
- 응용 계층에서 가짜 DHCP 서버 운영을 통해 클라이언트 네트워크 설정을 조작하는 공격

**방식**
- 공격자가 DHCP 서버로 위장하여 DHCP Offer 전송
- 정식 DHCP 서버보다 빠른 응답으로 클라이언트 유인
- 잘못된 게이트웨이와 DNS 서버 정보 제공

**원리**
- DHCP 클라이언트는 최초 수신한 DHCP Offer 수용
- DHCP 프로토콜의 서버 인증 메커니즘 부재
- 클라이언트는 제공된 네트워크 설정을 무조건 신뢰

**예시**
- 새로 접속하는 클라이언트가 DHCP 요청 브로드캐스트
- 공격자와 정식 DHCP 서버 모두 DHCP Offer 전송
- 공격자의 응답이 더 빨리 도착하여 클라이언트가 공격자를 게이트웨이로 설정
- 모든 트래픽이 공격자 경유

---

## 이메일 스푸핑 (Email Spoofing)

**정의**
- 응용 계층에서 발신자 이메일 주소를 위조하여 신뢰성을 획득하는 공격

**방식**
- SMTP 프로토콜의 From 헤더 직접 조작
- 유사 도메인 이름을 이용한 위장
- 회신 주소(Reply-To)를 악성 주소로 설정

**원리**
- SMTP 프로토콜은 발신자 주소 인증 메커니즘 부재
- 메일 클라이언트는 From 헤더를 무조건 신뢰하여 표시
- 사용자는 발신자 주소만으로 메일 신뢰성 판단

**예시**
- 공격자가 help@paypal-security.com으로 위장
- "PayPal 계정 이상 활동 감지"라는 제목의 피싱 메일 발송
- 수신자가 링크 클릭하여 가짜 PayPal 로그인 페이지에서 계정 정보 입력
- 공격자가 금융 정보 탈취

---

## 스푸핑 공격 비교표

| 공격 유형 | 대상 계층 | 공격 원리 | 주요 기법 | 대응 방안 |
|-----------|-----------|-----------|-----------|-----------|
| **ARP 스푸핑** | 데이터 링크 | ARP 프로토콜 인증 부재 | 위조 ARP 응답 전송 | Dynamic ARP Inspection |
| **IP 스푸핑** | 네트워크 | IP 주소 인증 메커니즘 부재 | Raw Socket 패킷 조작 | Ingress/Egress Filtering |
| **DNS 스푸핑** | 응용 | DNS 응답 무결성 검증 부재 | 캐시 포이즈닝, MITM | DNSSEC, DNS 모니터링 |
| **DHCP 스푸핑** | 응용 | DHCP 서버 인증 부재 | 가짜 DHCP 서버 운영 | DHCP Snooping |
| **이메일 스푸핑** | 응용 | SMTP 발신자 인증 부재 | From 헤더 조작 | SPF, DKIM, DMARC |
