# 파일 권한과 특수 권한 정리

## 1. 파일 권한의 개념

리눅스는 **모든 사용자에게 동일한 권한을 부여하지 않는다.**      
파일마다 접근할 수 있는 사용자와 권한이 다르며, 이를 통해 시스템 보안을 유지한다.       
각 파일은 **소유자(owner)**, **그룹(group)**, **기타 사용자(others)** 세 단계로 구분되어 권한이 설정된다.

파일 권한은 `ls -l` 명령어로 확인할 수 있으며, 다음과 같은 형태로 표시된다.

```
-rwxr-xr--
```

### 구성요소 설명

| 구분        | 의미                                            |
| --------- | --------------------------------------------- |
| 1번째 문자    | 파일의 종류 (`-`: 일반 파일, `d`: 디렉터리, `l`: 심볼릭 링크 등) |
| 2~4번째 문자  | 소유자(owner)의 권한 (`rwx`)                        |
| 5~7번째 문자  | 그룹(group)의 권한 (`r-x`)                         |
| 8~10번째 문자 | 기타 사용자(others)의 권한 (`r--`)                    |

---

## 2. 기본 권한의 의미

각 권한은 다음 세 가지로 구성된다.

| 기호 | 의미      | 설명                          |
| -- | ------- | --------------------------- |
| r  | Read    | 파일 내용을 읽을 수 있는 권한           |
| w  | Write   | 파일을 수정하거나 삭제할 수 있는 권한       |
| x  | Execute | 파일을 실행하거나 디렉터리에 접근할 수 있는 권한 |

### 디렉터리에서의 권한 의미

| 권한 | 설명                           |
| -- | ---------------------------- |
| r  | 디렉터리 내의 파일 목록을 볼 수 있음 (`ls`) |
| w  | 디렉터리 내 파일을 생성, 삭제, 이름 변경 가능  |
| x  | 디렉터리에 접근할 수 있음 (`cd`)        |

즉, **디렉터리에는 x 권한이 있어야 접근 가능**하다.
읽기(r)만 있고 실행(x)이 없다면, 목록은 볼 수 있지만 들어갈 수는 없다.

---

## 3. 숫자(8진수)로 표현하는 권한

각 권한은 숫자값으로도 표현할 수 있다.

| 권한 | 값 |
| -- | - |
| r  | 4 |
| w  | 2 |
| x  | 1 |

각 사용자 그룹의 권한은 이 값을 합산하여 나타낸다.
예를 들어,

* `rwx` → 4+2+1 = 7
* `r-x` → 4+0+1 = 5
* `r--` → 4+0+0 = 4

따라서 `rwxr-xr--`는 `754`로 표현된다.

---

## 4. 특수 권한(Special Permissions)

일반 권한 외에도 리눅스에는 **3가지 특수 권한**이 존재한다.
이는 실행, 소유, 삭제 등에서 추가적인 제어를 가능하게 한다.

| 특수 권한               | 기호 | 위치        | 기능                                                |
| ------------------- | -- | --------- | ------------------------------------------------- |
| SUID (Set User ID)  | s  | 소유자 실행 위치 | 프로그램 실행 시 **파일 소유자의 권한**으로 실행됨                    |
| SGID (Set Group ID) | s  | 그룹 실행 위치  | 프로그램 실행 시 **그룹 권한**으로 실행됨, 디렉터리 내 파일의 그룹도 동일하게 유지 |
| Sticky bit          | t  | 기타 실행 위치  | 디렉터리 내에서 **파일의 소유자만 삭제 가능**하게 설정                  |

---

## 5. 각 특수 권한의 작동 원리

### (1) SUID (Set User ID)

* 파일 실행 시 **현재 사용자의 권한이 아닌, 파일 소유자의 권한으로 실행**된다.
* 주로 관리자 권한이 필요한 명령어(`/usr/bin/passwd` 등)에 적용된다.
* 예를 들어, 일반 사용자가 비밀번호를 변경할 때, 실제로는 시스템 파일(`/etc/shadow`)을 수정해야 하므로 root 권한이 필요하다.
  이때 `passwd` 파일에 SUID가 설정되어 있으면 root 권한으로 실행된다.

**주의:**
SUID는 보안 위험을 유발할 수 있으므로, 일반 사용자 프로그램에는 설정하지 않는 것이 권장된다.

---

### (2) SGID (Set Group ID)

* 파일 실행 시 **그룹 권한으로 실행**된다.
* 디렉터리에 설정하면, 그 안에 새로 생성되는 파일은 **부모 디렉터리의 그룹 권한을 자동 상속**받는다.
* 여러 사용자가 같은 프로젝트 폴더를 공유할 때 유용하다.

**예시 상황:**
여러 명이 같은 그룹으로 협업 중일 때, 특정 디렉터리에 SGID를 부여하면
그 디렉터리 내의 모든 파일이 동일한 그룹 권한을 자동으로 가지게 되어
파일 관리가 일관되고 충돌이 줄어든다.

---

### (3) Sticky Bit

* 디렉터리에 설정하면, **누구나 쓰기 권한이 있어도 본인 파일만 삭제할 수 있다.**
* `/tmp` 디렉터리에 대표적으로 적용되어 있다.

**Sticky Bit가 필요한 이유:**

* `/tmp`는 시스템의 임시 폴더로, 모든 사용자가 자유롭게 파일을 생성한다.
* 만약 Sticky Bit가 없다면, 다른 사용자의 파일을 삭제할 수도 있게 되어 **보안 문제가 발생**한다.
* Sticky Bit를 설정하면, 디렉터리 내 파일을 오직 **파일 소유자나 root**만 삭제할 수 있다.

즉, Sticky Bit는 **공용 디렉터리에서의 파일 보호 장치** 역할을 한다.

---

## 6. 권한 구조 정리 표

| 항목        | 설명                                    |
| --------- | ------------------------------------- |
| 기본 권한     | r(4): 읽기, w(2): 쓰기, x(1): 실행          |
| 사용자 구분    | 소유자(owner), 그룹(group), 기타 사용자(others) |
| 특수 권한     | SUID(4), SGID(2), Sticky Bit(1)       |
| 설정 명령어    | `chmod` (Change Mode)                 |
| 권한 확인 명령어 | `ls -l`                               |
| 권한 변경 원리  | 기호 표기(`rwx`) 또는 숫자 표기(`754`)로 설정 가능   |

---

## 7. 실제 권한 문자열 해석 예시

| 권한 문자열      | 설명                                               |
| ----------- | ------------------------------------------------ |
| `rwsr-xr-x` | SUID 설정됨. 파일을 실행할 때 파일 소유자 권한으로 동작               |
| `rwxr-sr-x` | SGID 설정됨. 실행 시 그룹 권한으로 실행되거나, 디렉터리 내 새 파일이 그룹 상속 |
| `rwxr-xr-t` | Sticky Bit 설정됨. 해당 디렉터리에서 다른 사용자의 파일을 삭제할 수 없음   |
| `rw-rw-rw-` | 모든 사용자가 읽기/쓰기 가능하지만 실행은 불가능                      |
| `rwx------` | 소유자만 접근 가능, 완전한 개인 파일                            |

---

## 8. 핵심 요약

* **파일 권한(rwx)** 은 시스템 보안을 위한 최소 단위이다.
* **특수 권한(SUID, SGID, Sticky Bit)** 은 실행 또는 삭제 시 권한 동작을 세밀하게 제어한다.
* **Sticky Bit는 공용 디렉터리 보호를 위해 반드시 필요**하며, 보안상 필수적이다.
* **SUID, SGID는 신중히 사용**해야 하며, 불필요하게 부여할 경우 권한 상승 취약점을 초래할 수 있다.

---

이 문서는 리눅스 시스템의 권한 구조를 이해하고,
실제 운영 환경에서 보안과 접근 제어를 안전하게 설계하기 위한 기본 지침으로 사용할 수 있다.
