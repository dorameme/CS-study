# 스니핑 탐지 방법 비교표

## 다양한 스니핑 탐지 기술

| 탐지 방법 | 원리 | 사용 명령어 | 탐지 가능 공격 | 장점 | 단점 |
|-----------|------|-------------|----------------|------|------|
| **Ping 기반 탐지** | 가짜 IP로 Ping 전송 → 응답 오면 스니핑 | `ping 가짜IP` | 수동적 스니핑 | - 간단하게 실행 가능<br>- 추가 도구 불필요 | - 일부 스니퍼는 Ping 무시<br>- 위양성 가능 |
| **ARP 테이블 분석** | IP-MAC 주소 불일치 확인 | `arp -a` (Windows)<br>`arp -n` (Linux) | ARP 스푸핑<br>MAC 스푸핑 | - 실시간으로 빠른 확인<br>- 모든 시스템에서 사용 가능 | - 공격자가 ARP 테이블 정리하면 탐지 어려움 |
| **DNS 유인 탐지** | 가짜 호스트名으로 유인 → 접근 기록 확인 | 가짜 DNS 항목 생성 | 모든 스니핑 유형 | - 매우 정확한 탐지<br>- 확실한 증거 수집 | - 설정이 복잡<br>- 네트워크 관리자 권한 필요 |
| **ARP Watch** | ARP 테이블 변화 실시간 모니터링 | `arpwatch` 도구 설치 | ARP 스푸핑<br>MAC 주소 변조 | - 자동 경고 생성<br>- 이메일 알림 가능 | - 별도 소프트웨어 설치 필요<br>- 초기 설정 필요 |

---

## 🛠️ 상세 실행 방법

### Ping 기반 탐지
```bash
# 1. 가짜 IP 생성 (실제로 없는 IP)
ping 192.168.1.999

# 2. 응답이 오면 스니퍼가 존재함
# - 정상: "Destination host unreachable"
# - 스니핑: "Reply from 192.168.1.999"
```

**실제 예시:** 
- 공유기 대역이 192.168.0.1~192.168.0.100일 때
- `ping 192.168.0.200`으로 테스트
- 응답 오면 → **네트워크에 스니퍼 존재**

### ARP 테이블 분석
```bash
# Windows
arp -a
# 결과: 192.168.0.1 aa-bb-cc-dd-ee-ff

# Linux/Mac
arp -n
# 결과: 192.168.0.1 ether aa:bb:cc:dd:ee:ff
```

**이상 패턴 발견:**
- 동일 IP에 2개의 MAC 주소
- 알 수 없는 MAC 주소突然出现
- 게이트웨이 MAC 주소 변경

### DNS 유인 탐지
```bash
# 1. 가짜 호스트名 DNS 등록
# 예: monitor-secret.company.com → 192.168.0.999

# 2. DNS 쿼리 로그 모니터링
# 스니퍼가 이 주소를 조회하면 탐지됨
```

**실제 활용:**
- "회사내부-보안검사.server.com"
- "개인정보-백업.office.com"
- 이러한 주소로 접속 시도 로그 확인

### ARP Watch 설정
```bash
# Linux에서 설치
sudo apt-get install arpwatch

# 실행
sudo arpwatch -i eth0

# 로그 확인 (이메일 또는 파일)
# - "MAC address change detected"
# - "New station" 알림
```

---

## 📊 탐지 효과 비교

| 상황 | 추천 방법 | 이유 |
|------|-----------|------|
| **빠른 확인 필요** | ARP 테이블 분석 | 10초 내 결과 확인 가능 |
| **은밀한 탐지** | DNS 유인 탐지 | 공격자가 눈치채지 못함 |
| **지속적 모니터링** | ARP Watch | 24시간 자동 감시 |
| **초보자용** | Ping 테스트 | 기술적 지식 최소한으로 필요 |

---

## ⚡ 실생활 적용 시나리오

### 가정에서 의심될 때
1. **ARP 테이블 확인** (가장 쉬움)
2. **의심스러운 Ping 테스트**
3. **공유기 연결 장치 확인**

### 회사 네트워크에서
1. **ARP Watch 상시 가동**
2. **DNS 유인 트랩 여러 개 설치**
3. **정기적 Ping 스윕 테스트**

### 카페/공공 와이파이
1. **연결 전 ARP 테이블 확인**
2. **중요 정보 입력 전 Ping 테스트**
3. **의심스러운 AP 연결 금지**

---

## 탐지 시 대응 절차

1. **즉시 조치:** 네트워크 연결 차단
2. **증거 수집:** ARP 테이블, 로그 저장
3. **분석:** 어떤 방법으로 탐지되었는지 확인
4. **격리:** 감염된 장치 분리
5. **복구:** 보안 설정 강화 및 모니터링 강화

**기억할 점:** "한 가지 방법으로만 확인하지 말고, 여러 방법을 조합!"
